---
/**
 * ArticleCTA.astro
 * Minimal, safe CTA component used by /articles/[slug].astro
 * GitHub Pages project sites require BASE_URL prefix.
 * Visibility-enhanced (editorial-style CTA, not button-heavy).
 */
const base = (import.meta.env.BASE_URL || "/").replace(/\/$/, "");

const {
  title = "Viewing Contemporary Works",
  text = "Explore the current body of work, editions, and featured pieces.",
  buttonLabel = "View the work",
  href = "/art",
} = Astro.props;

// Normalize href:
// - Absolute URLs stay untouched
// - Root-relative URLs get BASE_URL prefix
const isAbsolute = typeof href === "string" && /^https?:\/\//i.test(href);

let resolvedHref = href;

if (!isAbsolute) {
  const h = typeof href === "string" ? href.trim() : "/art";
  const rootish = h.startsWith("/") ? h : `/${h}`;
  resolvedHref = `${base}${rootish}`;
}
---

<aside class="article-cta" aria-label="Article call to action">
  <h2 class="article-cta__title">{title}</h2>
  <p class="article-cta__text">{text}</p>
  <p class="article-cta__actions">
    <a class="article-cta__link" href={resolvedHref}>
      {buttonLabel}
    </a>
  </p>
</aside>

<style>
  /* Accent color â€” inherit site token safely */
  :global(:root) {
    --article-cta-accent: var(--color-accent, var(--accent, rgba(214, 179, 106, 1)));
  }

  .article-cta__link {
    color: var(--article-cta-accent);
    font-weight: 500;
    text-decoration: underline;
    text-decoration-thickness: 1.6px;
    text-underline-offset: 0.22em;
    text-decoration-color: rgba(214, 179, 106, 0.65);
  }

  .article-cta__link:hover,
  .article-cta__link:focus-visible {
    text-decoration-color: var(--article-cta-accent);
  }
</style>
